#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <math.h>
#include <vector>
#include <string>
#include <map>
#include <queue>
#define sz size()
#define MP make_pair
using namespace std;
typedef unsigned long long int64;

int64 g[] = {1, 3, 
5, 
9, 
11, 
19, 
21, 
35, 
37, 
43, 
69, 
73, 
75, 
83, 
85, 
139, 
147, 
149, 
165, 
171, 
277, 
293, 
299, 
331, 
339, 
341, 
555, 
587, 
595, 
597, 
661, 
683, 
1109, 
1173, 
1189, 
1195, 
1323, 
1355, 
1363, 
1365, 
2219, 
2347, 
2379, 
2387, 
2389, 
2645, 
2709, 
2731, 
4437, 
4691, 
4693, 
4757, 
4779, 
5291, 
5419, 
5451, 
5459, 
5461, 
8875, 
9387, 
9515, 
9547, 
9555, 
9557, 
10581, 
10837, 
10923, 
17749, 
18771, 
18773, 
19029, 
19093, 
19115, 
21163, 
21675, 
21803, 
21835, 
21843, 
21845, 
35499, 
37547, 
38059, 
38187, 
38219, 
38227, 
38229, 
42325, 
43349, 
43605, 
43691, 
70997, 
75091, 
75093, 
76117, 
76373, 
76459, 
84651, 
86699, 
87211, 
87339, 
87371, 
87379, 
87381, 
141995, 
150187, 
152235, 
152747, 
152875, 
152907, 
152915, 
152917, 
169301, 
173397, 
174421, 
174763, 
283989, 
300371, 
300373, 
304469, 
305493, 
305749, 
305835, 
338603, 
346795, 
348843, 
349355, 
349483, 
349515, 
349523, 
349525, 
567979, 
600747, 
608939, 
610987, 
611499, 
611627, 
611659, 
611667, 
611669, 
677205, 
693589, 
697685, 
698709, 
699051, 
1135957, 
1201491, 
1201493, 
1217877, 
1221973, 
1222997, 
1223339, 
1354411, 
1387179, 
1395371, 
1397419, 
1397931, 
1398059, 
1398091, 
1398099, 
1398101, 
2271915, 
2402987, 
2435755, 
2443947, 
2445995, 
2446507, 
2446635, 
2446667, 
2446675, 
2446677, 
2708821, 
2774357, 
2790741, 
2794837, 
2796203, 
4543829, 
4805971, 
4805973, 
4871509, 
4887893, 
4891989, 
4893013, 
4893355, 
5417643, 
5548715, 
5581483, 
5589675, 
5591723, 
5592235, 
5592363, 
5592395, 
5592403, 
5592405, 
9087659, 
9611947, 
9743019, 
9775787, 
9783979, 
9786027, 
9786539, 
9786667, 
9786699, 
9786707, 
9786709, 
10835285, 
11097429, 
11162965, 
11179349, 
11183445, 
11184469, 
11184725, 
11184789, 
11184805, 
11184811, 
18175317, 
19223893, 
19486037, 
19551573, 
19567957, 
19572053, 
19573077, 
19573333, 
19573397, 
19573413, 
19573419, 
21670571, 
22194859, 
22325931, 
22358699, 
22366891, 
22368939, 
22369451, 
22369579, 
22369611, 
22369621, 
36350635, 
38447787, 
38972075, 
39103147, 
39135915, 
39144107, 
39146155, 
39146667, 
39146795, 
39146827, 
39146837, 
43341141, 
44389717, 
44651861, 
44717397, 
44733781, 
44737877, 
44738901, 
44739157, 
44739221, 
44739243, 
72701269, 
76895573, 
77944149, 
78206293, 
78271829, 
78288213, 
78292309, 
78293333, 
78293589, 
78293653, 
78293675, 
86682283, 
88779435, 
89303723, 
89434795, 
89467563, 
89475755, 
89477803, 
89478315, 
89478443, 
89478485, 
145402539, 
153791147, 
155888299, 
156412587, 
156543659, 
156576427, 
156584619, 
156586667, 
156587179, 
156587307, 
156587349, 
173364565, 
177558869, 
178607445, 
178869589, 
178935125, 
178951509, 
178955605, 
178956629, 
178956885, 
178956971, 
290805077, 
307582293, 
311776597, 
312825173, 
313087317, 
313152853, 
313169237, 
313173333, 
313174357, 
313174613, 
313174699, 
346729131, 
355117739, 
357214891, 
357739179, 
357870251, 
357903019, 
357911211, 
357913259, 
357913771, 
357913941, 
581610155, 
615164587, 
623553195, 
625650347, 
626174635, 
626305707, 
626338475, 
626346667, 
626348715, 
626349227, 
626349397, 
693458261, 
710235477, 
714429781, 
715478357, 
715740501, 
715806037, 
715822421, 
715826517, 
715827541, 
715827883, 
1163220309, 
1230329173, 
1247106389, 
1251300693, 
1252349269, 
1252611413, 
1252676949, 
1252693333, 
1252697429, 
1252698453, 
1252698795, 
1386916523, 
1420470955, 
1428859563, 
1430956715, 
1431481003, 
1431612075, 
1431644843, 
1431653035, 
1431655083, 
1431655765, 
2326440619, 
2460658347, 
2494212779, 
2502601387, 
2504698539, 
2505222827, 
2505353899, 
2505386667, 
2505394859, 
2505396907, 
2505397589, 
2773833045, 
2840941909, 
2857719125, 
2861913429, 
2862962005, 
2863224149, 
2863289685, 
2863306069, 
2863310165, 
2863311531, 
4652881237, 
4921316693, 
4988425557, 
5005202773, 
5009397077, 
5010445653, 
5010707797, 
5010773333, 
5010789717, 
5010793813, 
5010795179, 
5547666091, 
5681883819, 
5715438251, 
5723826859, 
5725924011, 
5726448299, 
5726579371, 
5726612139, 
5726620331, 
5726623061, 
9305762475, 
9842633387, 
9976851115, 
10010405547, 
10018794155, 
10020891307, 
10021415595, 
10021546667, 
10021579435, 
10021587627, 
10021590357, 
11095332181, 
11363767637, 
11430876501, 
11447653717, 
11451848021, 
11452896597, 
11453158741, 
11453224277, 
11453240661, 
11453246123, 
18611524949, 
19685266773, 
19953702229, 
20020811093, 
20037588309, 
20041782613, 
20042831189, 
20043093333, 
20043158869, 
20043175253, 
20043180715, 
22190664363, 
22727535275, 
22861753003, 
22895307435, 
22903696043, 
22905793195, 
22906317483, 
22906448555, 
22906481323, 
22906492245, 
37223049899, 
39370533547, 
39907404459, 
40041622187, 
40075176619, 
40083565227, 
40085662379, 
40086186667, 
40086317739, 
40086350507, 
40086361429, 
44381328725, 
45455070549, 
45723506005, 
45790614869, 
45807392085, 
45811586389, 
45812634965, 
45812897109, 
45812962645, 
45812984491, 
74446099797, 
78741067093, 
79814808917, 
80083244373, 
80150353237, 
80167130453, 
80171324757, 
80172373333, 
80172635477, 
80172701013, 
80172722859, 
88762657451, 
90910141099, 
91447012011, 
91581229739, 
91614784171, 
91623172779, 
91625269931, 
91625794219, 
91625925291, 
91625968981, 
148892199595, 
157482134187, 
159629617835, 
160166488747, 
160300706475, 
160334260907, 
160342649515, 
160344746667, 
160345270955, 
160345402027, 
160345445717, 
177525314901, 
181820282197, 
182894024021, 
183162459477, 
183229568341, 
183246345557, 
183250539861, 
183251588437, 
183251850581, 
183251937963, 
297784399189, 
314964268373, 
319259235669, 
320332977493, 
320601412949, 
320668521813, 
320685299029, 
320689493333, 
320690541909, 
320690804053, 
320690891435, 
355050629803, 
363640564395, 
365788048043, 
366324918955, 
366459136683, 
366492691115, 
366501079723, 
366503176875, 
366503701163, 
366503875925, 
595568798379, 
629928536747, 
638518471339, 
640665954987, 
641202825899, 
641337043627, 
641370598059, 
641378986667, 
641381083819, 
641381608107, 
641381782869, 
710101259605, 
727281128789, 
731576096085, 
732649837909, 
732918273365, 
732985382229, 
733002159445, 
733006353749, 
733007402325, 
733007751851, 
1191137596757, 
1259857073493, 
1277036942677, 
1281331909973, 
1282405651797, 
1282674087253, 
1282741196117, 
1282757973333, 
1282762167637, 
1282763216213, 
1282763565739, 
1420202519211, 
1454562257579, 
1463152192171, 
1465299675819, 
1465836546731, 
1465970764459, 
1466004318891, 
1466012707499, 
1466014804651, 
1466015503701, 
2382275193515, 
2519714146987, 
2554073885355, 
2562663819947, 
2564811303595, 
2565348174507, 
2565482392235, 
2565515946667, 
2565524335275, 
2565526432427, 
2565527131477, 
2840405038421, 
2909124515157, 
2926304384341, 
2930599351637, 
2931673093461, 
2931941528917, 
2932008637781, 
2932025414997, 
2932029609301, 
2932031007403, 
4764550387029, 
5039428293973, 
5108147770709, 
5125327639893, 
5129622607189, 
5130696349013, 
5130964784469, 
5131031893333, 
5131048670549, 
5131052864853, 
5131054262955, 
5680810076843, 
5818249030315, 
5852608768683, 
5861198703275, 
5863346186923, 
5863883057835, 
5864017275563, 
5864050829995, 
5864059218603, 
5864062014805, 
9529100774059, 
10078856587947, 
10216295541419, 
10250655279787, 
10259245214379, 
10261392698027, 
10261929568939, 
10262063786667, 
10262097341099, 
10262105729707, 
10262108525909, 
11361620153685, 
11636498060629, 
11705217537365, 
11722397406549, 
11726692373845, 
11727766115669, 
11728034551125, 
11728101659989, 
11728118437205, 
11728124029611, 
19058201548117, 
20157713175893, 
20432591082837, 
20501310559573, 
20518490428757, 
20522785396053, 
20523859137877, 
20524127573333, 
20524194682197, 
20524211459413, 
20524217051819, 
22723240307371, 
23272996121259, 
23410435074731, 
23444794813099, 
23453384747691, 
23455532231339, 
23456069102251, 
23456203319979, 
23456236874411, 
23456248059221, 
38116403096235, 
40315426351787, 
40865182165675, 
41002621119147, 
41036980857515, 
41045570792107, 
41047718275755, 
41048255146667, 
41048389364395, 
41048422918827, 
41048434103637, 
45446480614741, 
46545992242517, 
46820870149461, 
46889589626197, 
46906769495381, 
46911064462677, 
46912138204501, 
46912406639957, 
46912473748821, 
46912496118443, 
76232806192469, 
80630852703573, 
81730364331349, 
82005242238293, 
82073961715029, 
82091141584213, 
82095436551509, 
82096510293333, 
82096778728789, 
82096845837653, 
82096868207275, 
90892961229483, 
93091984485035, 
93641740298923, 
93779179252395, 
93813538990763, 
93822128925355, 
93824276409003, 
93824813279915, 
93824947497643, 
93824992236885, 
152465612384939, 
161261705407147, 
163460728662699, 
164010484476587, 
164147923430059, 
164182283168427, 
164190873103019, 
164193020586667, 
164193557457579, 
164193691675307, 
164193736414549, 
181785922458965, 
186183968970069, 
187283480597845, 
187558358504789, 
187627077981525, 
187644257850709, 
187648552818005, 
187649626559829, 
187649894995285, 
187649984473771, 
304931224769877, 
322523410814293, 
326921457325397, 
328020968953173, 
328295846860117, 
328364566336853, 
328381746206037, 
328386041173333, 
328387114915157, 
328387383350613, 
328387472829099, 
363571844917931, 
372367937940139, 
374566961195691, 
375116717009579, 
375254155963051, 
375288515701419, 
375297105636011, 
375299253119659, 
375299789990571, 
375299968947541, 
609862449539755, 
645046821628587, 
653842914650795, 
656041937906347, 
656591693720235, 
656729132673707, 
656763492412075, 
656772082346667, 
656774229830315, 
656774766701227, 
656774945658197, 
727143689835861, 
744735875880277, 
749133922391381, 
750233434019157, 
750508311926101, 
750577031402837, 
750594211272021, 
750598506239317, 
750599579981141, 
750599937895083, 
1219724899079509, 
1290093643257173, 
1307685829301589, 
1312083875812693, 
1313183387440469, 
1313458265347413, 
1313526984824149, 
1313544164693333, 
1313548459660629, 
1313549533402453, 
1313549891316395, 
1454287379671723, 
1489471751760555, 
1498267844782763, 
1500466868038315, 
1501016623852203, 
1501154062805675, 
1501188422544043, 
1501197012478635, 
1501199159962283, 
1501199875790165, 
2439449798159019, 
2580187286514347, 
2615371658603179, 
2624167751625387, 
2626366774880939, 
2626916530694827, 
2627053969648299, 
2627088329386667, 
2627096919321259, 
2627099066804907, 
2627099782632789, 
2908574759343445, 
2978943503521109, 
2996535689565525, 
3000933736076629, 
3002033247704405, 
3002308125611349, 
3002376845088085, 
3002394024957269, 
3002398319924565, 
3002399751580331, 
4878899596318037, 
5160374573028693, 
5230743317206357, 
5248335503250773, 
5252733549761877, 
5253833061389653, 
5254107939296597, 
5254176658773333, 
5254193838642517, 
5254198133609813, 
5254199565265579, 
5817149518686891, 
5957887007042219, 
5993071379131051, 
6001867472153259, 
6004066495408811, 
6004616251222699, 
6004753690176171, 
6004788049914539, 
6004796639849131, 
6004799503160661, 
9757799192636075, 
10320749146057387, 
10461486634412715, 
10496671006501547, 
10505467099523755, 
10507666122779307, 
10508215878593195, 
10508353317546667, 
10508387677285035, 
10508396267219627, 
10508399130531157, 
11634299037373781, 
11915774014084437, 
11986142758262101, 
12003734944306517, 
12008132990817621, 
12009232502445397, 
12009507380352341, 
12009576099829077, 
12009593279698261, 
12009599006321323, 
19515598385272149, 
20641498292114773, 
20922973268825429, 
20993342013003093, 
21010934199047509, 
21015332245558613, 
21016431757186389, 
21016706635093333, 
21016775354570069, 
21016792534439253, 
21016798261062315, 
23268598074747563, 
23831548028168875, 
23972285516524203, 
24007469888613035, 
24016265981635243, 
24018465004890795, 
24019014760704683, 
24019152199658155, 
24019186559396523, 
24019198012642645, 
39031196770544299, 
41282996584229547, 
41845946537650859, 
41986684026006187, 
42021868398095019, 
42030664491117227, 
42032863514372779, 
42033413270186667, 
42033550709140139, 
42033585068878507, 
42033596522124629, 
46537196149495125, 
47663096056337749, 
47944571033048405, 
48014939777226069, 
48032531963270485, 
48036930009781589, 
48038029521409365, 
48038304399316309, 
48038373118793045, 
48038396025285291, 
78062393541088597, 
82565993168459093, 
83691893075301717, 
83973368052012373, 
84043736796190037, 
84061328982234453, 
84065727028745557, 
84066826540373333, 
84067101418280277, 
84067170137757013, 
84067193044249259, 
93074392298990251, 
95326192112675499, 
95889142066096811, 
96029879554452139, 
96065063926540971, 
96073860019563179, 
96076059042818731, 
96076608798632619, 
96076746237586091, 
96076792050570581, 
156124787082177195, 
165131986336918187, 
167383786150603435, 
167946736104024747, 
168087473592380075, 
168122657964468907, 
168131454057491115, 
168133653080746667, 
168134202836560555, 
168134340275514027, 
168134386088498517, 
186148784597980501, 
190652384225350997, 
191778284132193621, 
192059759108904277, 
192130127853081941, 
192147720039126357, 
192152118085637461, 
192153217597265237, 
192153492475172181, 
192153584101141163, 
312249574164354389, 
330263972673836373, 
334767572301206869, 
335893472208049493, 
336174947184760149, 
336245315928937813, 
336262908114982229, 
336267306161493333, 
336268405673121109, 
336268680551028053, 
336268772176997035, 
372297569195961003, 
381304768450701995, 
383556568264387243, 
384119518217808555, 
384260255706163883, 
384295440078252715, 
384304236171274923, 
384306435194530475, 
384306984950344363, 
384307168202282325, 
624499148328708779, 
660527945347672747, 
669535144602413739, 
671786944416098987, 
672349894369520299, 
672490631857875627, 
672525816229964459, 
672534612322986667, 
672536811346242219, 
672537361102056107, 
672537544353994069, 
744595138391922005, 
762609536901403989, 
767113136528774485, 
768239036435617109, 
768520511412327765, 
768590880156505429, 
768608472342549845, 
768612870389060949, 
768613969900688725, 
768614336404564651,
1000000000000000001};

map <int64, int64> w;

int64 rec(int64 x) {
	if (w.count(x)) return w[x];	
	if (x % 2) return w[x] = rec(x / 2) + rec(x / 2 + 1); else return w[x] = rec(x / 2);
}
/*
int64 go(int64 x) {	
	int t = 1;
	int64 po
	for (int64 i = 1; i <= x / 2; i <<= 1, t ^= 1) {
		if (t == 0 && ((x >> i) & 1) == 1) {													  
			po = i;																				  
		}																						  
	}
	t = 1;
	for (int64 i = 1; i <= x; i <<= 1, t ^= 1) {
		if (i <= po) ret += t * i; else
			ret += i * ((x >> i) & 1);
	}
	return rec(ret);
}
int main1() {	
	w[0] = 0;
	w[1] = 1;
	for (int i = 2; i <= 1000; i++) {
		if (i % 2) w[i] = w[i / 2] + w[i / 2 + 1]; else w[i] = w[i / 2];
	} 
	int dp[1001];
	dp[0] = 0;
	for (int i = 1; i <= 1000; i++) dp[i] = max(w[i], dp[i - 1]);
	while (true) {
		int64 n;
		scanf("%I64d", &n);
		if (!n) break;
		if (n <= 1000) printf("%d\n", dp[(int)n]); else printf("%I64d\n", go(n));
	}
	return 0;
}							


int main() {
	
	freopen("output.txt", "w", stdout);
	for (int i = 0; i < v.size(); i++) {
		printf("%I64d, \n", v[i]);
	}	
	printf("%d", v.size());
	return 0;
}*/
int64 gone(int64 x) {
	if ((x & 1) && (x & 2)) {
		if (x - 2 < (1LL << 59)) return ((x - 2) << 1) + 1; else return 0;
	} else {
		if (x < (1LL << 59)) return ((x << 1) + 1); else return 0;
	}
}
int64 gone2(int64 x) {
	if ((x & 1) && (x & 2)) {
		if (x - 1 < (1LL << 59)) return ((x - 1) << 1) + 1; else return 0;
	}
	return 0;
}
int dp[1001], p[1001], a[1001];
vector <int64> v;
int main() {
	w[0] = 0;
	w[1] = 1; 
	p[0] = dp[0] = a[0] = 0;
	dp[1] = p[1] = a[1] = 1;
	for (int i = 2; i <= 1000; i++) {
		if (i % 2) a[i] = a[i / 2] + a[i / 2 + 1]; else a[i] = a[i / 2];
		if (a[i] <= dp[i - 1]) {
			p[i] = p[i - 1];
			dp[i] = dp[i - 1];
		} else {
			p[i] = i;
			dp[i] = a[i];
			v.push_back(i);
		}
	}	
	for (int i = 0; i < v.size(); i++) {
		int64 y;
		if ((y = gone(v[i])) > v.back()) {
			v.push_back(y);
		}
		if ((y = gone2(v[i])) > v.back()) {
			v.push_back(y);
		}
	}
	while (true) {
		int64 n;
		scanf("%I64d", &n);
		if (!n) break;
		int l = 0, r = 970;
		while (l < r) {
			int mid = ((l + r) >> 1) + 1;
			if (g[mid] <= n) l = mid; else r = mid - 1;
		}
		printf("%I64d\n", rec(g[l]));
	}
	return 0;
}